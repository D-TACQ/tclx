#
# Makefile --
#
# Makefile for building Tcl sources used by wishx.
#------------------------------------------------------------------------------
# Copyright 1992 Karl Lehenbauer and Mark Diekhans.
#
# Permission to use, copy, modify, and distribute this software and its
# documentation for any purpose and without fee is hereby granted, provided
# that the above copyright notice appear in all copies.  Karl Lehenbauer and
# Mark Diekhans make no representations about the suitability of this
# software for any purpose.  It is provided "as is" without express or
# implied warranty.
#------------------------------------------------------------------------------
# $Id: Makefile,v 1.3 1993/07/18 15:21:42 markd Exp markd $
#------------------------------------------------------------------------------
#

include ../Config.mk
include ../config/${TCL_CONFIG_FILE}
SHELL=/bin/sh

#------------------------------------------------------------------------------

TK.TCL    = ../tkmaster/tk.tcl
TK.TLIB   = ../tkmaster/tk.tlib
TK.TNDX   = ../tkmaster/tk.tndx
PROLOG.PS = ../tkmaster/prolog.ps
TCLHELP   = ../tkmaster/bin/tclhelp
DEMOS     = ../tkmaster/demos
MAN       = ../tkmaster/man
HELP      = ../tkmaster/help

#------------------------------------------------------------------------------

all: ${TK.TCL} ${TK.TLIB} ${TK.TNDX} ${PROLOG.PS} ${TCLHELP} ${DEMOS} ${MAN}

${TK.TCL}: ../${TK_UCB_DIR}/library/tk.tcl
	rm -f ${TK.TCL}
	cp ../${TK_UCB_DIR}/library/tk.tcl ${TK.TCL}

${TK.TLIB} ${TK.TNDX}: ../${TK_UCB_DIR}/library/tclIndex tkdemo.tcl
	../runtcl "-c convert_lib ../${TK_UCB_DIR}/library/tclIndex ${TK.TLIB}"
	cat tkdemo.tcl >>${TK.TLIB}
	../runtcl "-c buildpackageindex ${TK.TLIB}"
	
${PROLOG.PS}: ../${TK_UCB_DIR}/library/prolog.ps
	cp ../${TK_UCB_DIR}/library/prolog.ps ${PROLOG.PS}

${TCLHELP}: tclhelp.tcl
	echo "#!${TCL_BINDIR}/wishx"  > ${TCLHELP}
	cat tclhelp.tcl               > ${TCLHELP}
	chmod +rx ${TCLHELP}

${DEMOS}:
	mkdir ${DEMOS}
	(cd ../${TK_UCB_DIR}/library/demos;tar -cf - .) | \
	    (cd ${DEMOS}; tar -xf -)

${MAN}:
	../runtcl ../tools/cpmanpages.tcl TK

#------------------------------------------------------------------------------
# Build help for Tk.

buildtkhelp:
	rm -rf ${HELP}
	mkdir ${HELP}
	../runtcl ../tools/bldmanhelp.tcl ../${TK_UCB_DIR}/doc \
                  ../tools/tkmanpages ${HELP} Tk.brf

#------------------------------------------------------------------------------

clean:
	rm -f ${TK.TCL} ${TK.TLIB} ${TK.TNDX} ${PROLOG.PS}
	rm -rf ${DEMOS} ${MAN}

